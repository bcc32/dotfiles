#!/usr/bin/env bash

set -eu

url=$1
ssh_client_ip=${SSH_CONNECTION%% *}

uuid=$(uuid -v4)
command=$(
  cat <<EOF
set -eu
mkdir -p .links-to-open/
cd .links-to-open
cat >$uuid.tmp
mv $uuid.tmp $uuid.url
EOF
)

ssh "$ssh_client_ip" "$command" <<<"$url"
