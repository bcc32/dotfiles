#!/usr/bin/env perl

use strict;
use warnings;

use File::Spec qw(splitpath);

open my $find, "find . -type f |";
open my $md5sum, "| gmd5sum -c --quiet";

local $\ = "\n";

while (my $path = <$find>) {
    chomp $path;
    my (undef, undef, $basename) = File::Spec->splitpath($path);
    if ($basename =~ /^([a-f0-9]{32})\.\w+$/i) {
        my $expected = $1;
        print $md5sum $expected, "  ", $path;
    }
}
